<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" />
    <title>Yapılacaklar Listesi</title>
</head>

<body>
    <div class="mr-1" style="position: relative">
        <div style="position: absolute; top: 0; right: 0">
            <div id="liveToast" class="toast success hide" role="alert" aria-live="assertive" aria-atomic="true"
                data-delay="4000">
                <div>
                    <button type="button" class="close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">Listeye ekleme işlemi gerçekleştirildi.</div>
            </div>
        </div>
    </div>
    <div class="mr-1" style="position: relative">
        <div style="position: absolute; top: 0; right: 0">
            <div id="liveToast" class="toast error hide" role="alert" aria-live="assertive" aria-atomic="true"
                data-delay="4000">
                <div>
                    <button type="button" class="close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">Listeye boş ekleme yapamazsınız!</div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="header">
            <img src="https://cdn.sanity.io/images/9kdepi1d/production/65c832d202a503b15d99e628f4313782f3ef50db-300x62.png"
                class="mb-1" alt="" />
            <h2>Yapılacaklar Listesi</h2>
            <input type="text" id="task" placeholder="Bugün ne yapacaksın?" />
            <span onclick="newElement()" id="liveToastBtn" class="button">Ekle</span>
        </div>
        <div class="card mt-3">
            <ul id="list" class="list-group list-group-flush">
            </ul>
        </div>
    </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
        crossorigin="anonymous"></script>
    <script src="js/script.js"></script>
    <script>

        let tasks = []

        // Yeni bir öğe ekleme fonksiyonu
        function newElement() {
            // Yeni bir öğe için bir li elementi oluştur
            let li = document.createElement("li");
            // Giriş kutusundaki değeri al
            let input = document.getElementById("task").value;
            // Giriş kutusunun boş olup olmadığını kontrol et
            if (input === "") {
                // Boşsa, hata bildirimi göster
                $(".error").toast("show");
            }
            else {
                // Değilse, li elementine giriş değerini ekle
                li.textContent = input;
                // Li elementine bir span elementi ekle
                let span = document.createElement("span");
                // Span elementine "close" sınıfı ve "x" metni ver
                span.className = "close";
                span.textContent = "x";
                // Li elementine span elementini ekle
                li.appendChild(span);
                // Listeye li elementini ekle
                list.appendChild(li);
                // Başarı bildirimi göster
                $(".success").toast("show");
                // Giriş kutusunu temizle
                document.getElementById("task").value = "";
                // Yapılacaklar listesine yeni öğeyi ekle
                tasks.push(input);
                // Yapılacaklar listesini stringe dönüştür
                let tasksString = JSON.stringify(tasks);
                // Yapılacaklar listesini localStorage'a kaydet
                localStorage.setItem("tasks", tasksString);
            }
        }

        // Listeye tıklandığında, tıklanan öğeyi seç 
        list.addEventListener("click", function (task) {
            if (task.target.tagName === "LI") {
                task.target.classList.toggle("checked");
            }
        });

        list.onclick = function (event) {
            // Tıklanan öğeyi seç
            let target = event.target;
            // Tıklanan öğenin bir span elementi olup olmadığını kontrol et
            if (target.tagName === "SPAN") {
                // Span elementinin üst öğesini, yani li elementini seç
                let li = target.parentNode;
                // Tıklanan öğe işaretlenmiş mi diye kontrol et
                if (li.classList.contains("checked")) {
                    // İşaretlenmişse, listedeki li elementinin indeksini bul
                    let index = Array.from(list.children).indexOf(li);
                    // Listedeki li elementini sil
                    list.removeChild(li);
                    // Yapılacaklar listesinden silinen öğeyi çıkar
                    tasks.splice(index, 1);
                    // Yapılacaklar listesini stringe dönüştür
                    let tasksString = JSON.stringify(tasks);
                    // Yapılacaklar listesini localStorage'a kaydet
                    localStorage.setItem("tasks", tasksString);
                }
                else {
                    // İşaretlenmemişse, span elementine checked sınıfını ekle
                    li.classList.add("checked");
                }
            }
        };



        // Sayfa yüklendiğinde, localStorage'dan verileri al
        window.onload = function () {
            let storedTasks = localStorage.getItem("tasks");
            if (storedTasks) {
                tasks = JSON.parse(storedTasks);
                tasks.forEach(function (task) {
                    let li = document.createElement("li");
                    li.textContent = task;
                    let span = document.createElement("span");
                    span.className = "close";
                    span.textContent = "x";
                    li.appendChild(span);
                    list.appendChild(li);
                });
            }
        };
    </script>
</body>

</html>